<div class="window-content">
    <div class="visage-selector-header">
        <h3 class="visage-title">{{localize "VISAGE.Selector.Title"}}</h3>
        <button type="button" class="visage-config-button" data-tooltip="{{localize 'VISAGE.Selector.Configure'}}" data-action="openConfig">
            <img src="modules/visage/icons/settings.svg" alt="Settings"/>
        </button>
    </div>
    <div class="visage-selector-grid-wrapper">
        <div class="visage-selector">
            {{#each forms}}
            <div class="visage-tile {{#if this.isActive}}active{{/if}}" 
                 data-action="selectVisage" 
                 data-form-key="{{this.key}}"
                 tabindex="0" 
                 role="button" 
                 aria-label="{{this.name}}" 
                 aria-pressed="{{this.isActive}}">
 
                <div class="visage-image-wrapper {{#if this.hasInvisibility}}invisible{{/if}}">
                    {{#if this.hasRing}}
                        <div class="visage-ring-preview {{#if this.hasPulse}}pulse{{/if}} {{#if this.hasGradient}}gradient{{/if}} {{#if this.hasWave}}wave{{/if}}" 
                             style="--ring-color: {{this.ringColor}}; --ring-bkg: {{this.ringBkg}};">
                             <div class="ring-band outer"></div>
                             <div class="ring-band inner"></div>
                        </div>
                    {{/if}}
                    
                    {{#if this.isVideo}}
                        <video class="{{#if this.hasRing}}circular{{/if}}" src="{{this.resolvedPath}}" autoplay loop muted playsinline></video>
                    {{else}}
                        <img class="{{#if this.hasRing}}circular{{/if}}" src="{{this.resolvedPath}}" alt="{{this.name}}"/>
                    {{/if}}
                </div>

                <span class="visage-tile-name" data-tooltip="{{this.name}}">{{this.name}}</span>
                
                {{#if this.isActive}}
                <div class="visage-chip" data-tooltip="{{localize 'VISAGE.Selector.Active'}}">
                     <img src="modules/visage/icons/check_circle.svg" alt="{{localize 'VISAGE.Selector.Active'}}"/>
                </div>
                {{/if}}
                
                {{#if this.isDefault}}
                <div class="visage-default-indicator" data-tooltip="{{localize 'VISAGE.Selector.Default'}}">
                     <img src="modules/visage/icons/stars.svg" alt="{{localize 'VISAGE.Selector.Default'}}"/>
                </div>
                {{/if}}
                
                {{#if this.showScaleChip}}
                <div class="visage-data-chip">
                    {{#if this.isFlippedX}}
                    <img class="visage-flip-icon" src="modules/visage/icons/flip.svg" alt="{{localize 'VISAGE.Selector.Flipped'}}" data-tooltip="{{localize 'VISAGE.Selector.Flipped'}}"/>
                    {{/if}}
                    {{#if (ne this.absScale 1)}}
                     <span class="visage-scale-value">{{this.displayScale}}%</span>
                    {{/if}}
                </div>
                {{/if}}

                {{#if this.isWildcard}}
                <div class="visage-wildcard-indicator" data-tooltip="{{localize 'VISAGE.Selector.Wildcard'}}">
                     <img src="modules/visage/icons/shuffle.svg" alt="{{localize 'VISAGE.Selector.WildcardAlt'}}"/>
                </div>
                {{/if}}

                {{#if this.showDispositionChip}}
                <div class="visage-disposition-chip {{this.dispositionClass}}" data-tooltip="{{this.dispositionName}}">
                     <span>{{this.dispositionName}}</span>
                </div>
                {{/if}}

            </div>
            {{/each}}
        </div>
    </div>
</div>
{{!-- modules/visage/templates/visage-config-app.hbs --}}

<div class="visage-config-container">
    <div class="visage-config-wrapper visage-scrollable">
        <div class="visage-config-pane">
            
            {{!-- DEFAULT STATE SECTION --}}
            <fieldset class="visage-fieldset default-section">
                <legend>{{defaultLegend}}</legend>
                <p class="visage-notes">{{defaultHint}}</p>

                {{!-- GROUPED HEADER --}}
                <div class="visage-list-header-group">
                    <span class="header-spacer"></span> {{!-- Name --}}
                    <span class="header-spacer"></span> {{!-- Image --}}
                    <span class="header-group-label visual">{{localize "VISAGE.Config.Group.Visual"}}</span>
                    <span class="header-group-label dimensions">{{localize "VISAGE.Config.Group.Dimensions"}}</span>
                    <span class="header-spacer"></span> {{!-- Delete --}}
                </div>

                <div class="visage-list-header">
                    <span>{{localize "VISAGE.Config.List.Name"}}</span>
                    <span>{{localize "VISAGE.Config.List.Image"}}</span>
                    
                    {{!-- Visual Group --}}
                    <span class="centered">{{localize "VISAGE.Config.List.Scale"}}</span>
                    <div class="visage-flip-header centered">
                        <i class="fas fa-arrows-alt-h" data-tooltip="{{localize 'VISAGE.Mirror.Horizontal.Label'}}"></i>
                        <i class="fas fa-arrows-alt-v" data-tooltip="{{localize 'VISAGE.Mirror.Vertical.Label'}}"></i>
                    </div>
                    <span class="centered">{{localize "VISAGE.Config.List.Disposition"}}</span>
                    <span class="centered">{{localize "VISAGE.RingConfig.Ring"}}</span>
                    
                    {{!-- Token Dimensions Group --}}
                    <span class="centered">{{localize "VISAGE.Config.List.Width"}}</span>
                    <span class="centered">{{localize "VISAGE.Config.List.Height"}}</span>
                    
                    <span></span>
                </div>

                <ol class="visage-list">
                    <li class="visage-list-item default-row">
                        <div class="form-group">
                            <input type="text" value="{{defaultVisage.name}}" disabled data-tooltip="{{defaultVisage.name}}" />
                        </div>

                        <div class="form-group">
                            <div class="visage-form-fields">
                                <input type="text" class="force-ltr" value="{{defaultVisage.path}}" disabled data-tooltip="{{defaultVisage.path}}" />
                                <button type="button" class="file-picker-button" disabled style="opacity: 0;"><i class="fas fa-file-import fa-fw"></i></button>
                            </div>
                        </div>

                        {{!-- Visual Inputs --}}
                        <div class="visage-scale-group">
                            <input type="number" value="{{defaultVisage.scale}}" disabled class="visage-scale-input">
                            <span class="visage-percent-sign">%</span>
                        </div>

                        <div class="visage-flip-group centered">
                            {{!-- Horizontal Flip (Read Only) --}}
                            <input class="visage-checkbox" type="checkbox" {{checked defaultVisage.isFlippedX}} disabled>
                            
                            {{!-- Vertical Flip (Read Only) --}}
                            <input class="visage-checkbox" type="checkbox" {{checked defaultVisage.isFlippedY}} disabled>
                        </div>
                        
                        <div class="visage-disposition-cell">
                            <button type="button" class="visage-disposition-button" disabled>
                                {{defaultVisage.dispositionButtonText}}
                            </button>
                        </div>
                        
                        <div class="visage-ring-cell">
                            <button type="button" class="visage-ring-button {{defaultVisage.ringClass}}" disabled data-tooltip="{{defaultVisage.ringTooltip}}">
                                <i class="{{defaultVisage.ringIcon}}"></i>
                            </button>
                        </div>

                        {{!-- Token Dimensions Inputs (Default) --}}
                        <div class="visage-dimension-group">
                            <input type="number" value="{{defaultVisage.width}}" disabled class="visage-dim-input" data-tooltip="{{localize 'VISAGE.Config.Tooltips.Width'}}">
                        </div>
                        <div class="visage-dimension-group">
                            <input type="number" value="{{defaultVisage.height}}" disabled class="visage-dim-input" data-tooltip="{{localize 'VISAGE.Config.Tooltips.Height'}}">
                        </div>
                        
                        <span></span>
                    </li>
                </ol>
            </fieldset>
            
            {{!-- ALTERNATE VISAGES SECTION --}}
            <fieldset class="visage-fieldset">
                <legend>{{localize "VISAGE.Config.Legend"}}</legend>
                <p class="visage-notes">{{localize "VISAGE.Config.LegendHint"}}</p>
                
                {{!-- REPEAT HEADER FOR CLARITY --}}
                <div class="visage-list-header-group">
                    <span class="header-spacer"></span>
                    <span class="header-spacer"></span>
                    <span class="header-group-label visual">{{localize "VISAGE.Config.Group.Visual"}}</span>
                    <span class="header-group-label dimensions">{{localize "VISAGE.Config.Group.Dimensions"}}</span>
                    <span class="header-spacer"></span>
                </div>
                
                <div class="visage-list-header">
                    <span>{{localize "VISAGE.Config.List.Name"}}</span>
                    <span>{{localize "VISAGE.Config.List.Image"}}</span>
                    <span class="centered">
                        {{localize "VISAGE.Config.List.Scale"}}
                        <i class="fas fa-info-circle visage-info-icon" data-tooltip="{{localize 'VISAGE.Config.Tooltips.ScaleHeader'}}"></i>
                    </span>
                    <div class="visage-flip-header centered">
                        <i class="fas fa-arrows-alt-h" data-tooltip="{{localize 'VISAGE.Mirror.Horizontal.Label'}}"></i>
                        <i class="fas fa-arrows-alt-v" data-tooltip="{{localize 'VISAGE.Mirror.Vertical.Label'}}"></i>
                    </div>
                    <span class="centered">{{localize "VISAGE.Config.List.Disposition"}}</span>
                    <span class="centered">{{localize "VISAGE.RingConfig.Ring"}}</span>
                    <span class="centered">{{localize "VISAGE.Config.List.Width"}}</span>
                    <span class="centered">{{localize "VISAGE.Config.List.Height"}}</span>
                    <span></span>
                </div>
                
                <ol class="visage-list">
                    {{#each visages}}
                    <li class="visage-list-item" data-id="{{this.id}}" data-index="{{@index}}">
                        <input type="hidden" name="visages.{{@index}}.id" value="{{this.id}}">
                        <input type="hidden" name="visages.{{@index}}.ringJSON" value="{{json this.ring}}">
                        
                        <input type="text" name="visages.{{@index}}.name" value="{{this.name}}" placeholder="{{localize 'VISAGE.Config.Placeholder.Name'}}" data-tooltip="{{this.name}}" />
                        
                        <div class="visage-path-group visage-form-fields">
                            <input type="text" name="visages.{{@index}}.path" value="{{this.path}}" placeholder="{{localize 'VISAGE.Config.Placeholder.Path'}}" data-tooltip="{{this.path}}" />
                            <button type="button" class="file-picker-button" data-action="openFilePicker"><i class="fas fa-file-import fa-fw"></i></button>
                        </div>
                        
                        {{!-- Visual --}}
                        <div class="visage-scale-group">
                            <input type="number" name="visages.{{@index}}.scale" value="{{this.scale}}" min="0" max="500" step="5" class="visage-scale-input">
                            <span class="visage-percent-sign">%</span>
                        </div>
                
                        <div class="visage-flip-group centered">
                            <input class="visage-checkbox" type="checkbox" name="visages.{{@index}}.isFlippedX" {{checked this.isFlippedX}}>
                            <input class="visage-checkbox" type="checkbox" name="visages.{{@index}}.isFlippedY" {{checked this.isFlippedY}}>
                        </div>
                     
                        <div class="visage-disposition-cell">
                            <button type="button" class="visage-disposition-button" data-action="toggleDisposition">
                                {{this.dispositionButtonText}}
                            </button>
                            
                            <div class="visage-disposition-popout">
                                <div class="form-group">
                                    <input type="radio" name="visages.{{@index}}.dispositionType" value="none" {{checked (eq this.dispositionType "none")}} data-action="changeDispositionType" />
                                    <label>{{localize "VISAGE.Config.Disposition.Label.Default"}}</label>
                                </div>
                                <div class="form-group">
                                    <input type="radio" name="visages.{{@index}}.dispositionType" value="disguise" {{checked (eq this.dispositionType "disguise")}} data-action="changeDispositionType" />
                                    <label>{{localize "VISAGE.Config.Disposition.Label.Disguise"}}</label>
                                    <select name="visages.{{@index}}.dispositionValue" {{disabled (neq this.dispositionType "disguise")}} data-action="changeDispositionValue">
                                        <option value="1" {{visageSelected (eq this.dispositionValue 1)}}>{{localize "VISAGE.Disposition.Friendly"}}</option>
                                        <option value="0" {{visageSelected (eq this.dispositionValue 0)}}>{{localize "VISAGE.Disposition.Neutral"}}</option>
                                        <option value="-1" {{visageSelected (eq this.dispositionValue -1)}}>{{localize "VISAGE.Disposition.Hostile"}}</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <input type="radio" name="visages.{{@index}}.dispositionType" value="illusion" {{checked (eq this.dispositionType "illusion")}} data-action="changeDispositionType" />
                                    <label>{{localize "VISAGE.Config.Disposition.Label.Illusion"}}</label>
                                </div>
                            </div>
                        </div>

                        <div class="visage-ring-cell">
                            <button type="button" class="visage-ring-button {{this.ringClass}}" data-action="openRingEditor" data-tooltip="{{this.ringTooltip}}">
                                <i class="{{this.ringIcon}}"></i>
                            </button>
                        </div>

                        {{!-- Token Dimensions Inputs --}}
                        <div class="visage-dimension-group">
                            <input type="number" name="visages.{{@index}}.width" value="{{this.width}}" min="0.5" step="0.5" class="visage-dim-input" placeholder="W" data-tooltip="{{localize 'VISAGE.Config.Tooltips.Width'}}">
                        </div>
                        <div class="visage-dimension-group">
                            <input type="number" name="visages.{{@index}}.height" value="{{this.height}}" min="0.5" step="0.5" class="visage-dim-input" placeholder="H" data-tooltip="{{localize 'VISAGE.Config.Tooltips.Height'}}">
                        </div>

                        <a class="visage-delete" data-action="deleteVisage" data-tooltip="VISAGE.Config.Tooltips.Delete"><i class="fas fa-trash"></i></a>
                    </li>
                    {{else}}
                    <li class="visage-empty-state">
                        <p>{{localize "VISAGE.Config.EmptyState.Title"}}</p>
                        <span>{{localize "VISAGE.Config.EmptyState.Hint"}}</span>
                    </li>
                    {{/each}}
                </ol>

                <div class="flexrow visage-add-wrapper">
                    <button type="button" class="visage-add" data-action="addVisage"><i class="fas fa-plus"></i> {{localize "VISAGE.Config.Button.Add"}}</button>        
                </div>
            </fieldset>
        </div>
    </div>
    
    <footer class="visage-config-footer">
        <button type="submit" class="visage-save {{#if isDirty}}dirty{{/if}}" data-action="save"><i class="fas fa-save"></i> {{localize "VISAGE.Config.Button.Save"}}</button>
    </footer>
</div>
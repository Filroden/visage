<div class="visage-config-container">
    <div class="visage-config-wrapper">
        <div class="visage-config-pane">
            <p class="visage-notes">
                {{localize "VISAGE.Config.Notes"}}
            </p>

            <div class="visage-defaults-grid">
                <div class="form-group">
                    <label>{{localize "VISAGE.Config.DefaultName"}}</label>
                    <div class="form-fields">
                        <span class="visage-readonly-field">{{defaultTokenName}}</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>{{localize "VISAGE.Config.DefaultImage"}}</label>
                    <div class="form-fields">
                        <span class="visage-readonly-field">{{defaultToken}}</span>
                    </div>
                </div>
            </div>
            
            <fieldset class="visage-config-fieldset">
                <legend>{{localize "VISAGE.Config.Legend"}}</legend>
                <p class="visage-notes">{{localize "VISAGE.Config.LegendHint"}}</p>
                
                <div class="visage-list-header">
                    <span>{{localize "VISAGE.Config.List.Name"}}</span>
                    <span>{{localize "VISAGE.Config.List.Image"}}</span>
                    <span style="text-align: center;">{{localize "VISAGE.Config.List.Scale"}}</span>
                    <span style="text-align: center;">{{localize "VISAGE.Config.List.Flip"}}</span>
                    <span style="text-align: center;">{{localize "VISAGE.Config.List.Disposition"}}</span>
                    <span></span>
                </div>
                
                <ol class="visage-list">
                    {{#each visages}}
                    <li class="visage-list-item" data-id="{{this.id}}">
                        <input type="hidden" name="visages.{{@index}}.id" value="{{this.id}}">
                        
                        <input type="text" name="visages.{{@index}}.name" value="{{this.name}}" placeholder="{{localize 'VISAGE.Config.Placeholder.Name'}}" />
                        
                        <div class="visage-path-group form-fields">
                            <input type="text" name="visages.{{@index}}.path" value="{{this.path}}" placeholder="{{localize 'VISAGE.Config.Placeholder.Path'}}" />
                            <button type="button" class="file-picker-button" data-action="openFilePicker"><i class="fas fa-file-import fa-fw"></i></button>
                        </div>
                        
                        <div class="visage-scale-group">
                            <input type="number" name="visages.{{@index}}.scale" value="{{this.scale}}" placeholder="{{localize 'VISAGE.Config.Placeholder.Scale'}}" min="0" max="500" step="5" class="visage-scale-input">
                            <span class="visage-percent-sign">%</span>
                        </div>
                
                        <label class="checkbox visage-flip-label">
                            <input type="checkbox" name="visages.{{@index}}.isFlippedX" {{checked this.isFlippedX}}> 
                        </label>
                    
                        <div class="visage-disposition-cell">
                            <button type="button" class="visage-disposition-button" data-action="toggleDisposition">
                                {{this.dispositionButtonText}}
                            </button>
                            
                            <div class="visage-disposition-popout">
                                <div class="form-group">
                                    <input type="radio" name="visages.{{@index}}.dispositionType" value="none" 
                                      {{checked (eq this.dispositionType "none")}} data-action="changeDispositionType" />
                                    <label>{{localize "VISAGE.Config.Disposition.Label.Default"}}</label>
                                </div>

                                <div class="form-group">
                                    <input type="radio" name="visages.{{@index}}.dispositionType" value="disguise" 
                                         {{checked (eq this.dispositionType "disguise")}} data-action="changeDispositionType" />
                                    <label>{{localize "VISAGE.Config.Disposition.Label.Disguise"}}</label>
                                    <select name="visages.{{@index}}.dispositionValue" 
                                        {{disabled (neq this.dispositionType "disguise")}} data-action="changeDispositionValue">
                                        <option value="1" {{selected (eq this.dispositionValue 1)}}>{{localize "VISAGE.Disposition.Friendly"}}</option>
                                        <option value="0" {{selected (eq this.dispositionValue 0)}}>{{localize "VISAGE.Disposition.Neutral"}}</option>
                                        <option value="-1" {{selected (eq this.dispositionValue -1)}}>{{localize "VISAGE.Disposition.Hostile"}}</option>
                                     </select>
                                </div>

                                <div class="form-group">
                                    <input type="radio" name="visages.{{@index}}.dispositionType" value="illusion" 
                                        {{checked (eq this.dispositionType "illusion")}} data-action="changeDispositionType" />
                                    <label>{{localize "VISAGE.Config.Disposition.Label.Illusion"}}</label>
                                </div>
                            </div>
                        </div>

                        <a class="visage-delete" data-action="deleteVisage" data-tooltip="VISAGE.Config.Tooltips.Delete"><i class="fas fa-trash"></i></a>
                    </li>
                    {{else}}
                    <li class="visage-empty-state">
                        <p>{{localize "VISAGE.Config.EmptyState.Title"}}</p>
                        <span>{{localize "VISAGE.Config.EmptyState.Hint"}}</span>
                    </li>
                    {{/each}}
                </ol>

                <div class="flexrow visage-add-wrapper">
                    <button type="button" class="visage-add" data-action="addVisage"><i class="fas fa-plus"></i> {{localize "VISAGE.Config.Button.Add"}}</button>        
                </div>
            </fieldset>
        </div>
    </div>

    <footer class="visage-config-footer">
        <button type="submit" class="visage-save {{#if isDirty}}dirty{{/if}}" data-action="save"><i class="fas fa-save"></i> {{localize "VISAGE.Config.Button.Save"}}</button>
    </footer>
</div>